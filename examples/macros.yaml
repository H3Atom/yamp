---
- defmacro:
    name: template
    args: [beginning, middle , end]
    value:
      deploy:
        - boilerplate
        - beginning
        - some intermediate
        - middle
        - inermediate
        - end
- define:
    name: data
    value:
      hotname: lll123
      ports: [21, 22]
      username: jill
      password: 1231231==

---
- template:
    beginning: 
      shutdown_server: 20 seconds
    middle:
      deploy:
        something: {'+': [23, 11]}
        timeout: 3 h
        facts: data
    end: start server

- first_port: data.ports.0
